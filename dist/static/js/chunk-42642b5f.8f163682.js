(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42642b5f"],{"85b7":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("input",{ref:"photoref",attrs:{type:"file",accept:"image/*",capture:"camera"},on:{change:function(e){return t.Photograph()}}})},r=[];o("513c"),o("e18c"),o("e35a"),o("1c2e8"),o("5e9f"),o("6a61");function s(t,e,o,n,r,s,i){try{var a=t[s](i),c=a.value}catch(u){return void o(u)}a.done?e(c):Promise.resolve(c).then(n,r)}function i(t){return function(){var e=this,o=arguments;return new Promise((function(n,r){var i=t.apply(e,o);function a(t){s(i,n,r,a,c,"next",t)}function c(t){s(i,n,r,a,c,"throw",t)}a(void 0)}))}}var a=o("7c15"),c=o("751a"),u={name:"Photograph",data:function(){return{msgLists:this.msgList,msgSrcs:this.msgSrc,base64ImgData:null,userId:localStorage.getItem("userId")}},props:["msgList","msgSrc"],computed:{robotId:function(){return this.$store.state.robotInfo.robotId},isAdd:function(){return!(this.newform.question&&this.newform.answer&&this.newform.source)}},methods:{Photograph:function(){var t=this;return i(regeneratorRuntime.mark((function e(){var o,n,r,s,i,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=t.$refs.photoref.files[0],e.next=3,t.FileReader(o);case 3:t.base64ImgData=e.sent,n=new FormData,n.append("image",o),r={"Content-Type":"multipart/formdata;charset=utf-8","X-CSRF-Token":window.localStorage.getItem("token")},s="",i={userId:t.userId},c={},u={},void 0!==t.msgList?(t.$store.commit("setLoadingShow",!0),s=a["a"].port8085.uploadImgUrl,t.checkPhoto(s,i,n,r,c,u)):(s=a["a"].port8085.saveUserInfo,t.msgSrcs=t.base64ImgData,t.uploadUserInfo={msgPreviewSrc:t.base64ImgData,imgFile:o,takePhoto:!0},t.$emit("photoMsg",t.uploadUserInfo));case 12:case"end":return e.stop()}}),e)})))()},FileReader:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=new FileReader;return e.readAsDataURL(t),new Promise((function(t){return e.onloadend=function(){return t(e.result)}}))})),checkPhoto:function(t,e,o,n,r,s){var i=this;r={type:"user",imgUrl:this.base64ImgData,updateold:!1},this.msgLists.push(r),this.$emit("photoMsg",this.msgLists),s={idx:this.msgList.length-1,owner:"robot",msg:[{type:"text",content:"",code:null}]},Object(c["b"])(t,e,o,n).then((function(t){t&&t.msg.length>0&&(s.owner="robot",s.msg[0].code=Number(t.code),s.msg[0].content=t.msg.replace(/\n\r/g,"<br/>").replace(/\n/g,"<br/>")),i.$nextTick((function(){i.msgLists.push(s),i.$emit("photoMsg",i.msgLists),setTimeout((function(){var t=document.getElementsByClassName("divScroll");t[0].scrollTop=t[0].scrollHeight}),0)})),i.$store.commit("setLoadingShow",!1),i.$store.commit("setToppPointmodelShow",!1)})).catch((function(t){i.$store.commit("setLoadingShow",!1),i.$store.commit("setToppPointmodelShow",!1)}))}},components:{}},m=u,h=(o("99b2"),o("c701")),g=Object(h["a"])(m,n,r,!1,null,"4df308ce",null);e["default"]=g.exports},"99b2":function(t,e,o){"use strict";o("9f9d")},"9f9d":function(t,e,o){}}]);