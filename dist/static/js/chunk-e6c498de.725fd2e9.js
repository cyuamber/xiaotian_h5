(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e6c498de"],{"85b7":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{ref:"photoref",attrs:{type:"file",accept:"image/*",capture:"camera"},on:{change:function(e){return t.Photograph()}}})},r=[];n("513c"),n("e18c"),n("e35a"),n("1c2e8"),n("5e9f"),n("6a61");function s(t,e,n,o,r,s,a){try{var i=t[s](a),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(o,r)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function i(t){s(a,o,r,i,c,"next",t)}function c(t){s(a,o,r,i,c,"throw",t)}i(void 0)}))}}var i=n("7c15"),c=n("751a"),u={name:"Photograph",data:function(){return{msgLists:this.msgList,msgSrcs:this.msgSrc,base64ImgData:null,userId:localStorage.getItem("userId")}},props:["msgList","msgSrc"],computed:{robotId:function(){return this.$store.state.robotInfo.robotId},isAdd:function(){return!(this.newform.question&&this.newform.answer&&this.newform.source)}},methods:{Photograph:function(){var t=this;return a(regeneratorRuntime.mark((function e(){var n,o,r,s,a,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.$refs.photoref.files[0],e.next=3,t.FileReader(n);case 3:t.base64ImgData=e.sent,o=new FormData,o.append("image",n),r={"Content-Type":"multipart/formdata;charset=utf-8","X-CSRF-Token":window.localStorage.getItem("token")},s="",a={userId:t.userId},c={},u={},void 0!==t.msgList?(t.$store.commit("setLoadingShow",!0),s=i["a"].port8085.uploadImgUrl,t.checkPhoto(s,a,o,r,c,u)):(s=i["a"].port8085.saveUserInfo,t.msgSrcs=t.base64ImgData,t.uploadUserInfo={msgPreviewSrc:t.base64ImgData,imgFile:n,takePhoto:!0},t.$emit("photoMsg",t.uploadUserInfo));case 12:case"end":return e.stop()}}),e)})))()},FileReader:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=new FileReader;return e.readAsDataURL(t),new Promise((function(t){return e.onloadend=function(){return t(e.result)}}))})),checkPhoto:function(t,e,n,o,r,s){var a=this;r={type:"user",imgUrl:this.base64ImgData,updateold:!1},this.msgLists.push(r),this.$emit("photoMsg",this.msgLists),s={idx:this.msgList.length-1,owner:"robot",msg:[{type:"text",content:"",code:null}]},Object(c["b"])(t,e,n,o).then((function(t){t&&t.msg.length>0&&(s.owner="robot",s.msg[0].code=Number(t.code),s.msg[0].content=t.msg.replace(/\n\r/g,"<br/>").replace(/\n/g,"<br/>")),a.$nextTick((function(){a.msgLists.push(s),a.$emit("photoMsg",a.msgLists),setTimeout((function(){var t=document.getElementsByClassName("divScroll");t[0].scrollTop=t[0].scrollHeight}),0)})),a.$store.commit("setLoadingShow",!1)})).catch((function(t){a.$store.commit("setLoadingShow",!1)}))}},components:{}},m=u,g=(n("d11f"),n("9ca4")),h=Object(g["a"])(m,o,r,!1,null,"3f3292d0",null);e["default"]=h.exports},d11f:function(t,e,n){"use strict";var o=n("e7f0"),r=n.n(o);r.a},e7f0:function(t,e,n){}}]);