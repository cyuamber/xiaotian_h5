(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-421f43a8"],{"0405":function(t,e,n){},1702:function(t,e,n){},"23bd":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"componentBody"}},[i("div",{staticClass:"drawerBody"},[i("van-sticky",{staticClass:"top"},[t._l(t.clockInPoint,(function(e,n){return i("span",{key:n,staticClass:"top-point",class:{ischeck:!0===e.isCheck},on:{click:function(){return t.getInformation(e)}}},[t._v(" "+t._s(e.title)+" ")])})),i("van-popup",{style:{width:"80%",height:"80%"},model:{value:t.toppPointmodelShow,callback:function(e){t.toppPointmodelShow=e},expression:"toppPointmodelShow"}},[i("van-swipe",{staticClass:"my-swipe",staticStyle:{height:"95%"},attrs:{"indicator-color":"#6A6A6A"}},t._l(t.pointInfo,(function(e,a){return i("van-swipe-item",{key:a},[i("img",{attrs:{src:n("e9a8"),width:"60%",alt:"小天机器人"}}),i("p",{staticClass:"point-information"},[t._v(" "+t._s(e.info)+" ")]),i("span",{staticClass:"top-point point-model"},[t._v(" "+t._s(e.key)+" ")])])})),1)],1)],2),i("div",{staticClass:"bodyDialog divScroll"},[i("Chatbox",{attrs:{msgList:t.msgList}})],1),i("div",{staticClass:"footer"},[i("div",{staticClass:"common-question"},t._l(t.commonQuestion,(function(e,n){return i("span",{key:n,on:{click:function(e){return t.quickClick()}}},[t._v(" "+t._s(e)+" ")])})),0),i("div",{staticClass:"bodyInput"},[i("van-icon",{directives:[{name:"show",rawName:"v-show",value:!t.textSwitch,expression:"!textSwitch"}],staticClass:"footer-icon",staticStyle:{"margin-right":"0.2rem"},attrs:{name:"add-o",size:"0.8rem"},on:{click:function(e){return t.textButtonSwitch()}}}),i("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.textSwitch,expression:"textSwitch"}],staticClass:"footer-icon",staticStyle:{"margin-right":"0.2rem"},attrs:{name:"volume-o",size:"0.8rem"},on:{click:function(e){return t.textButtonSwitch()}}}),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputContent,expression:"inputContent"},{name:"show",rawName:"v-show",value:!t.textSwitch,expression:"!textSwitch"}],staticClass:"inputArea",attrs:{placeholder:"请在此填写问题"},domProps:{value:t.inputContent},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.pressEnter(e)},input:function(e){e.target.composing||(t.inputContent=e.target.value)}}}),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:t.textSwitch,expression:"textSwitch"}],staticClass:"talk",on:{touchstart:t.talkStart,touchend:t.talkEndClear}},[i("van-icon",{staticStyle:{"margin-right":"5px"},attrs:{name:"chat-o",size:"15"}}),t._v("按住说话 ")],1),i("van-icon",{staticClass:"footer-icon",attrs:{name:"sign",size:"0.8rem"}})],1)])],1),t.LoadingShow?i("Loading"):t._e(),i("Recorder")],1)},a=[],s=(n("ac1f"),n("466d"),n("5319"),n("5530")),o=n("2f62"),r=(n("d3b7"),n("bc3a")),c=n.n(r),u=function(){return{}},l=c.a.create({baseURL:"",withCredentials:!0,crossDomain:!0,timeout:3e4});function h(t,e,n,i){return new Promise((function(n,a){l({method:"GET",url:t,params:e,headers:i||u()}).then((function(t){n(t.data)})).catch((function(t){a(t)}))}))}var d=[{key:"C",info:"1. 在大会现场找到中移九天公众号二维码并通过微信扫描，打开推送链接"},{key:"H",info:"2. 根据地图指引，在CHBN打卡点处拍照并上传，小天会自动判断是否打卡成功（每个类别有多个打卡点，只要打卡一次上传成功即可）"},{key:"B",info:"3. 集齐CHBN共4个类别的打卡点，获取小天为您准备的大会独家记忆"},{key:"N",info:"4. 凭本人记忆页面展示给工作人员，即可领取盲盒"}],v=["如何打卡","如何获取打卡地图","中国移动合作伙伴大会历史","大会规则","大会简介"],m=[{type:"text",value:"根据地图指引，在CHBN打卡点处拍照并上传，小天会自动判断是否打卡成功（每个类别有多个打卡点，只要打卡一次上传成功即可）"},{type:"img",value:"http://img01.jituwang.com/171110/256775-1G11021324561.jpg"}],f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-loading",{staticClass:"loading",attrs:{type:"spinner",color:"#1989fa"}})},p=[],g={name:"Loading",data:function(){return{}},methods:{}},w=g,C=(n("53a2"),n("2877")),b=Object(C["a"])(w,f,p,!1,null,null,null),k=b.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chatbox"},[t._l(t.msgList,(function(e,i){return n("div",{key:i},["robot"===e.owner?n("div",{staticClass:"msg-box"},[t._m(0,!0),n("div",{staticClass:"robotMsg"},[t._l(e.msg,(function(e,i){return n("div",{key:i},["text"===e.type?n("div",[t._v(t._s(e.value))]):"img"===e.type?n("img",{attrs:{src:e.value,alt:"小天机器人"},on:{click:function(n){return t.showImage(e.value)}}}):t._e()])})),e.init?n("div",[n("p",{staticClass:"hot-issue",on:{click:function(e){return t.quickClick()}}},[t._v("如何打卡")]),n("p",{staticClass:"hot-issue",on:{click:function(e){return t.quickClick()}}},[t._v("获取打卡地图")])]):t._e()],2)]):t._e(),"user"===e.type?n("div",{staticClass:"msg-box users-box"},[t._m(1,!0),n("div",{staticClass:"userMsg"},[n("span",[t._v(t._s(e.oldform.question))])])]):t._e()])})),n("van-popup",{staticClass:"picHolder",model:{value:t.showPic,callback:function(e){t.showPic=e},expression:"showPic"}},[n("van-image",{attrs:{width:"100%",src:t.picLink}})],1)],2)},S=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"robot-img"},[i("img",{attrs:{src:n("8422"),alt:"小天机器人"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"robot-img"},[i("img",{attrs:{src:n("6f8b"),alt:"小天机器人"}})])}],x={name:"Chatbox",props:{msgList:""},data:function(){return{showPic:!1,picLink:""}},methods:{quickClick:function(){var t=window.event,e={type:"user",oldform:{question:t.target.innerHTML,answer:"",source:""},updateold:!1};this.$parent.getAnswer(e),t.preventDefault()},showImage:function(t){this.showPic=!0,this.picLink=t}}},_=x,T=(n("9e9a"),Object(C["a"])(_,y,S,!1,null,"4d65d61a",null)),I=T.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-overlay",{attrs:{show:t.maskShow}},[n("div",{staticClass:"wrapper"},[n("div",{staticClass:"canvas",attrs:{id:"canvas"}},[n("canvas",{staticClass:"visualizer",attrs:{width:"400",height:"0"}}),n("canvas",{staticClass:"visualizers",staticStyle:{transform:"rotateX(180deg)"},attrs:{width:"400",height:"0"}})]),n("input",{attrs:{type:"hidden",id:"visual",value:"frequencybars"}})])])},E=[];n("ace4"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("fb6a"),n("c19f"),n("b0c0"),n("a9e3"),n("25f0"),n("3ca3"),n("cfc3"),n("fd87"),n("ddb0"),n("2b3d");window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var L,A=[],q=[],D=[],B=0,N=3200,M=null,U=0,O=1,z=0;function P(){if(1===U){"WebSocket"in window?M=new WebSocket("wss://172.31.232.108:5010"):alert("当前浏览器 Not support websocket"),M.onerror=function(){},M.onopen=function(){F()},M.onclose=function(t){};M.onmessage=function(t){var e=JSON.parse(t.data);1==e.end&&M.close()}}else setTimeout(P,100)}P();var j,F=function t(){var e=Number(localStorage.getItem("recorderFlage"));if(N<A.length){D=A.slice(B,N);for(var n="",i=new Uint8Array(D),a=i.byteLength,s=0;s<a;s++)n+=String.fromCharCode(i[s]);var o=window.btoa(n);z=1==O?1:2;var r={uid:ID,state:z,chunk:O,audio:o},c=JSON.stringify(r);M.send(c),B+=3200,N+=3200,O+=1,t()}else{if(!(N>=A.length&&0!==e)){O+=1;r={uid:ID,state:3,chunk:O,audio:""},c=JSON.stringify(r);return M.send(c),void H()}setTimeout(t,1e3)}};function H(){$("#text div").on("click",(function(){j=Number(this.dataset.key),0!==j&&(j-=1);var t={id:ID,wav_key:j};$.post("../transfer-realtime/click-content-audio-wav",t,(function(t){$(".progress_bar_audio").attr("src",t.path)}),"json")}))}function W(t,e){var n=0,i=10880;e=e||{},e.sampleBits=e.sampleBits||8,e.sampleRate=e.sampleRate||7350;var a=new(window.webkitAudioContext||window.AudioContext),s=a.createMediaStreamSource(t),o=a.createScriptProcessor||a.createJavaScriptNode,r=o.apply(a,[16384,1,1]),c={size:0,buffer:[],inputSampleRate:a.sampleRate,inputSampleBits:16,outputSampleRate:e.sampleRate,oututSampleBits:e.sampleBits,input:function(t){this.buffer.push(new Float32Array(t)),this.size+=t.length},compress:function(){for(var t=new Float32Array(this.size),e=0,n=0;n<this.buffer.length;n++)t.set(this.buffer[n],e),e+=this.buffer[n].length;var i=parseInt(this.inputSampleRate/this.outputSampleRate),a=t.length/i,s=new Float32Array(a),o=0,r=0;while(o<a)s[o]=t[r],r+=i,o++;return s},encodeWAV:function(){Math.min(this.inputSampleRate,this.outputSampleRate);var t=Math.min(this.inputSampleBits,this.oututSampleBits),e=this.compress(),a=e.length*(t/8),s=new ArrayBuffer(a),o=new DataView(s),r=0;if(8===t)for(var c=0;c<e.length;c++,r++){var u=Math.max(-1,Math.min(1,e[c])),l=u<0?32768*u:32767*u;l=parseInt(255/(65535/(l+32768))),o.setInt8(r,l,!0)}else for(c=0;c<e.length;c++,r+=2){u=Math.max(-1,Math.min(1,e[c]));o.setInt16(r,u<0?32768*u:32767*u,!0)}L=new Int8Array(o.buffer),A=L,q=L.slice(n,i);new Blob([q],{type:"audio/wav"});1,n+=10880,i+=10880}};this.start=function(){s.connect(r),r.connect(a.destination),U=1},this.pause=function(){r.disconnect()},this.resume=function(){r.connect(a.destination)},this.stop=function(){r.disconnect(),1},this.getBlob=function(){return c.encodeWAV()},this.play=function(t){t.src=window.URL.createObjectURL(this.getBlob())},r.onaudioprocess=function(t){return c.input(t.inputBuffer.getChannelData(0)),c.encodeWAV()}}W.throwError=function(t){throw alert(t),new function(){this.toString=function(){return t}}},W.canRecording=null!=navigator.getUserMedia,W.get=function(t,e){t&&navigator.getUserMedia&&navigator.getUserMedia({audio:!0},(function(n){var i=new W(n,e);t(i,n)}),(function(t){switch(t.code||t.name){case"PERMISSION_DENIED":case"PermissionDeniedError":W.throwError("用户拒绝提供信息。");break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":W.throwError("浏览器不支持硬件设备。");break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":W.throwError("无法发现指定的硬件设备。");break;default:W.throwError("无法打开麦克风。异常信息:"+(t.code||t.name));break}}))};var G={name:"Recorder",data:function(){return{leftDataList:[],audioContext:null,recorder:null,mediaStream:null,videoEnabled:!1,analyser:null,distortion:null,gainNode:null,biquadFilter:null,convolver:null,canvas:null,canvaT:null,canvasCtx:null,canvasCtxT:null,visualSelect:null,drawVisual:null,savecount:0,time:new Date("2019/1/10").getTime(),timeD:null,millisecond:null,second:null,minute:null,hour:null,file_num_current:0,int:null,z:!1,key:1,readTransferContentkey:1,chunks:[],tmpChunks:[],ajaxUrl:1,file_num:1,end:null,reader:null}},computed:Object(s["a"])({},Object(o["b"])({maskShow:function(t){return t.app.maskShow},talkText:function(t){return t.app.talkText}})),watch:{maskShow:function(t){t?this.start():this.stop()}},mounted:function(){this.init()},methods:{init:function(){this.canvas=document.querySelector(".visualizer"),this.canvaT=document.querySelector(".visualizers"),this.canvasCtx=this.canvas.getContext("2d"),this.canvasCtxT=this.canvaT.getContext("2d"),this.canvas.setAttribute("width",400),this.canvaT.setAttribute("width",400),this.visualSelect=document.getElementById("visual"),this.savecount=0,this.time=new Date("2019/1/10").getTime(),this.timeD=(new Date).getTime()-this.time,this.millisecond=new Date(this.time).getMilliseconds(),this.second=new Date(this.time).getSeconds(),this.minute=new Date(this.time).getMinutes(),this.hour=new Date(this.time).getHours(),this.file_num_current=0,this.z=!1,this.key=1,this.readTransferContentkey=1,localStorage.setItem("recorderFlage",1),this.chunks=[],this.tmpChunks=[],this.ajaxUrl=1,this.file_num=1},start:function(t,e){var n=this;localStorage.setItem("start",1),this.canvas=document.querySelector(".visualizer"),this.canvaT=document.querySelector(".visualizers"),this.canvasCtx=this.canvas.getContext("2d"),this.canvasCtxT=this.canvaT.getContext("2d"),this.savecount=0,this.canvas.setAttribute("height",40),this.canvaT.setAttribute("height",40),W.get((function(t,e){n.recorder=t,n.recorder.start(),n.beginRecord(e),n.visualize()}),{sampleBits:16,sampleRate:16e3})},stop:function(){this.end="end",this.disvisualize(),this.recorder.stop(),this.canvas.setAttribute("height",0),this.canvaT.setAttribute("height",0),this.start=0;var t=0;localStorage.setItem("start",start),localStorage.setItem("recorderFlage",t)},beginRecord:function(t){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser(),this.analyser.minDecibels=-90,this.analyser.maxDecibels=-10,this.analyser.smoothingTimeConstant=.85,this.distortion=this.audioContext.createWaveShaper(),this.gainNode=this.audioContext.createGain(),this.biquadFilter=this.audioContext.createBiquadFilter(),this.convolver=this.audioContext.createConvolver(),this.source=this.audioContext.createMediaStreamSource(t),this.source.connect(this.analyser),this.analyser.connect(this.distortion),this.distortion.connect(this.biquadFilter),this.biquadFilter.connect(this.convolver),this.convolver.connect(this.gainNode),this.gainNode.connect(this.audioContext.destination)},visualize:function(){var t=this;this.canvas.width=200,this.canvas.height=40;var e=this.visualSelect.value;if("frequencybars"==e){this.analyser.fftSize=2048;var n=this.analyser.frequencyBinCount,i=new Uint8Array(n);this.canvasCtx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvasCtxT.clearRect(0,0,this.canvas.width,this.canvas.height);var a=function e(){t.drawVisual=requestAnimationFrame(e),t.analyser.getByteFrequencyData(i),t.canvasCtx.clearRect(0,0,t.canvas.width,t.canvas.height),t.canvasCtx.fillStyle="rgba(0, 0, 0, 0)",t.canvasCtx.fillRect(10,10,t.canvas.width,t.canvas.height),t.canvasCtxT.clearRect(0,0,t.canvas.width,t.canvas.height),t.canvasCtxT.fillStyle="rgba(0, 0, 0, 0)",t.canvasCtxT.fillRect(10,10,t.canvas.width,t.canvas.height);for(var a,s=t.canvas.width/n*10.5,o=0,r=0;r<n;r++)a=i[r],t.canvasCtx.fillStyle="rgb("+(a+100)+",255,255)",t.canvasCtx.fillRect(o,t.canvas.height-a/2,s,a/2),t.canvasCtxT.fillStyle="rgb("+(a+100)+",255,255)",t.canvasCtxT.fillRect(o,t.canvas.height-a/2,s,a/2),o+=s+3};a()}},disvisualize:function(){this.canvas.width=100,this.canvas.height=100;visualSelect.value;this.analyser.fftSize=2048,this.canvasCtx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvasCtxT.clearRect(0,0,this.canvas.width,this.canvas.height)}}},J=G,V=(n("2a7c"),Object(C["a"])(J,R,E,!1,null,null,null)),Q=V.exports,X="/port8085",Y="/port9101",K={port8085:{dialogUrl:X+"/chatxx.php",getCheckInInformationUrl:X+"/getCheckInInformationUrl"},port9101:{addUrl:Y+"/dangwu?op=add"}},Z={name:"RobotTestBtn",components:{Loading:k,Chatbox:I,Recorder:Q},data:function(){return{inputContent:"",msgList:[],width:document.body.clientWidth,newform:{question:"",answer:"",source:""},username:"",phonenum:"",commonQuestion:v,clockInPoint:[{key:"",title:"C",isCheck:!1},{key:"",title:"H",isCheck:!1},{key:"",title:"B",isCheck:!1},{key:"",title:"N",isCheck:!0}],toppPointmodelShow:!1,pointInfo:[],LoadingShow:!1,textSwitch:!1,timeOutEvent:0}},methods:{showDrawer:function(){this.msgList=[];var t={owner:"robot",type:"text",init:!0,msg:[{type:"text",value:"您好，欢迎来到中国移动合作伙伴大会，我是移动“融智”战略下诞生的智能机器人小天。接下来请跟随我一起游览展台、拍照打卡、领取礼品、吧~见到我的立牌就拍照上传吧~"}]};this.msgList.push(t)},quickClick:function(){var t=window.event,e={type:"user",oldform:{question:t.target.innerHTML,answer:"",source:""},updateold:!1};this.getAnswer(e),t.preventDefault()},getAnswer:function(t){var e=this,n={uid:this.userId,l:100,c:this.$route.query.c,q:t.oldform.question},i=K.port8085.dialogUrl,a={userid:this.userId};this.msgList.push(t);var s={idx:this.msgList.length-1,owner:"robot",msg:""};this.inputContent="",this.LoadingShow=!0,h(i,n,a).then((function(t){t&&t.a.length>0&&t.a[0].a&&(s.owner="robot",s.msg=t.a[0].a.replace(/\n\r/g,"<br/>").replace(/\n/g,"<br/>")),e.$nextTick((function(){e.msgList.push(s),setTimeout((function(){var t=document.getElementsByClassName("divScroll");t[0].scrollTop=t[0].scrollHeight}),0)})),e.LoadingShow=!1})).catch((function(){e.LoadingShow=!1,s.msg=m,e.$nextTick((function(){e.msgList.push(s),setTimeout((function(){var t=document.getElementsByClassName("divScroll");t[0].scrollTop=t[0].scrollHeight}),0)}))}))},textButtonSwitch:function(){this.textSwitch?this.textSwitch=!1:this.textSwitch=!0},talkEndClear:function(t){return t.stopPropagation(),clearTimeout(this.timeOutEvent),0!==this.timeOutEvent||this.$store.commit("setMaskShow",!1),!1},talkStart:function(t){var e=this;return t.stopPropagation(),this.timeOutEvent=setTimeout((function(){e.timeOutEvent=0,e.$store.commit("setMaskShow",!0)}),500),!1},getInformation:function(t){var e=this;this.toppPointmodelShow=!0;var n={key:t.title},i=K.port8085.getCheckInInformationUrl;this.LoadingShow=!0,h(i,n).then((function(t){e.pointInfo=t,e.LoadingShow=!1})).catch((function(){e.pointInfo=d,e.LoadingShow=!1}))},pressEnter:function(t){if(!this.inputContent.match(/^[ ]*$/)){var e={type:"user",oldform:{question:this.inputContent,answer:"",source:""},updateold:!1};this.getAnswer(e)}t.preventDefault()}},computed:Object(s["a"])(Object(s["a"])({},Object(o["b"])(["channelno"])),{},{userId:function(){return this.$store.state.userId},robotId:function(){return this.$store.state.robotInfo.robotId},isAdd:function(){return!(this.newform.question&&this.newform.answer&&this.newform.source)}}),created:function(){this.showDrawer(),this.username=this.$route.query.username,this.phonenum=this.$route.query.phonenum}},tt=Z,et=(n("bb91"),n("f129"),Object(C["a"])(tt,i,a,!1,null,"64039aaf",null));e["default"]=et.exports},"2a7c":function(t,e,n){"use strict";var i=n("1702"),a=n.n(i);a.a},5257:function(t,e,n){},"53a2":function(t,e,n){"use strict";var i=n("0405"),a=n.n(i);a.a},"6f8b":function(t,e,n){t.exports=n.p+"static/img/useravator.4e1bc72b.png"},8422:function(t,e,n){t.exports=n.p+"static/img/robotavator.bb2bf286.png"},"9a03":function(t,e,n){},"9e9a":function(t,e,n){"use strict";var i=n("9a03"),a=n.n(i);a.a},bb91:function(t,e,n){"use strict";var i=n("c873"),a=n.n(i);a.a},c873:function(t,e,n){},e9a8:function(t,e,n){t.exports=n.p+"static/img/xiaotian.1f213bd3.png"},f129:function(t,e,n){"use strict";var i=n("5257"),a=n.n(i);a.a}}]);